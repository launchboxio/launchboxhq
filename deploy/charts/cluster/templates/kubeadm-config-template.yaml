apiVersion: bootstrap.cluster.x-k8s.io/v1beta1
kind: KubeadmConfigTemplate
metadata:
  name: {{ .Release.Name }}
  namespace: {{ .Release.Namespace }}
spec:
  template:
    spec:
      {{- if eq .Values.cloud "digitalocean" }}
      joinConfiguration:
        nodeRegistration:
          kubeletExtraArgs:
            cloud-provider: external
          name: '{{ "{{" }} ds.meta_data.local_hostname {{ "}}" }}'
      {{- else if eq .Values.cloud "google" }}
      joinConfiguration:
        nodeRegistration:
          kubeletExtraArgs:
            cloud-provider: gce
          name: '{{ "{{" }} ds.meta_data.local_hostname.split(".")[0] {{ "}}" }}'
      {{- end }}