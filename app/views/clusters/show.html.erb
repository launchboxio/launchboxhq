<div class="row">
  <div class="col-md-12">
    <div class="card">
      <div class="card-header">Cluster Info</div>
      <div class="card-body">

      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-md-12">
    <div class="card">
      <div class="card-header">Agents</div>
      <div class="card-body">
        <% if @cluster.agents.length > 0 %>
        <table>
          <tr>
            <th>Pod Name</th>
            <th>Node Name</th>
            <th>Status</th>
            <th>Last Ping</th>
          </tr>
          <% @cluster.agents.each do |agent| %>
          <tr>
            <td><%= agent.pod_name %></td>
            <td><%= agent.node_name %></td>
            <td><%= agent.status %></td>
            <td><%= agent.last_communication %></td>
          </tr>
          <% end %>
        </table>
        <% else %>
        <div class="alert alert-warning">
          This cluster doesn't have any agents. Click 'Add Agent' to get started
        </div>
        <% end %>
      </div>
      <div class="card-footer">
        <button class="btn" data-bs-toggle="modal" data-bs-target="#launchAgentModal">
          Add Agent
        </button>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-md-6">
    <div class="card">
      <div class="card-header">Spaces</div>
      <div class="card-body">
        <table class="table">
          <tr>
            <th>Name</th>
            <th>CPU</th>
            <th>Memory</th>
            <th>Disk</th>
            <th>GPU</th>
            <th>State</th>
          </tr>
          <% @cluster.spaces.each do |space| %>
          <tr>
            <td><%= space.name %></td>
            <td><%= space.cpu %></td>
            <td><%= space.memory %></td>
            <td><%= space.disk %></td>
            <td><%= space.status %></td>
          </tr>
          <% end %>
        </table>
      </div>
    </div>
  </div>

  <div class="col-md-6">
    <div class="card">
      <div class="card-header">Other settings</div>
      <div class="card-body"></div>
    </div>
  </div>
</div>

<div class="modal fade" id="launchAgentModal" tabindex="-1" aria-labelledby="launchAgentModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="launchAgentModalLabel">Agent Configuration</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p>Connect to the Kubernetes cluster you want to service this resource, and run the following command:</p>
        <pre>
          <code>
helm install launchboxhq/launchbox-agent \
  -n lbx-system \
  --set agent.token=<%= @cluster.agent_token %> \
  --set cluster.id=<%= @cluster.id %>
          </code>
        </pre>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>